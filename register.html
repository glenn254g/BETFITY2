<!-- Supabase JS -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
    // FIXED: Use "db" instead of supabase to avoid breaking the script
    const db = supabase.createClient(
        "https://curktrkcwobraducbkzj.supabase.co",
        "sb_publishable_tTjEWEJtcNYqK95wamq3cw_nkLdW-A2"
    );

    const form = document.getElementById("registerForm");
    const statusBox = document.getElementById("status");

    form.addEventListener("submit", async (e) => {
        e.preventDefault();

        let username = document.getElementById("name").value.trim();
        let mobile = document.getElementById("mobile").value.trim();
        let password = document.getElementById("password").value.trim();
        let promo = document.getElementById("promocode").value.trim();
        let terms = document.getElementById("terms").checked;

        if (!username || !mobile || !password) {
            statusBox.style.color = "red";
            statusBox.textContent = "All fields are required!";
            return;
        }

        if (!terms) {
            statusBox.style.color = "red";
            statusBox.textContent = "You must accept the terms!";
            return;
        }

        statusBox.textContent = "Creating account...";

        const { data, error } = await db.auth.signUp({
            email: mobile + "@betfity.fake",
            password: password,
            options: {
                data: {
                    username: username,
                    mobile: mobile,
                    promo: promo
                }
            }
        });

        if (error) {
            statusBox.style.color = "red";
            statusBox.textContent = error.message;
        } else {
            statusBox.style.color = "#4CAF50";
            statusBox.textContent = "Account created successfully!";
        }
    });
</script>
